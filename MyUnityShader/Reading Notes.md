# Unity Shader 入门精要 - Reading Notes
    Shader 不只是 UnityShader
- [Unity Shader 入门精要 - Reading Notes](#unity-shader-入门精要---reading-notes)
  - [1.程序员的三大浪漫:](#1程序员的三大浪漫)
  - [2.渲染流水线:](#2渲染流水线)
    - [2.1.1 应用阶段](#211-应用阶段)
    - [2.1.2 几何阶段](#212-几何阶段)
    - [2.1.3 光栅化阶段](#213-光栅化阶段)
  - [2.2 CPU和GPU之间的通信](#22-cpu和gpu之间的通信)
  - [2.3 GPU流水线](#23-gpu流水线)
  - [2.3.1 顶点着色器](#231-顶点着色器)

## 1.程序员的三大浪漫:
    编译原理
    操作系统
    图形学
## 2.渲染流水线:
    渲染流水线的工作任务:
        由一个三维场景出发、生成(渲染)一张二维图像

    渲染流水线的三个阶段:
        应用阶段(输出渲染图元)
        几何阶段(输出屏幕空间的顶点信息)
        光栅化阶段
### 2.1.1 应用阶段
    主要任务(CPU):
        1.场景数据
        包括位置信息,模型信息,光源等

        2.粗粒度剔除
        为了提高渲染性能,把不可见的物体剔除出去,不需要再移交给几何阶段进行处理

        3.设置渲染状态
        设置好每个模型的渲染状态,包括但不限于它使用的材质(漫反射颜色、高光反射颜色)、使用的纹理、使用的shader等，输出渲染图元(渲染所需的几何信息,一般是点、线、三角面等)
### 2.1.2 几何阶段
    主要任务(GPU)：
        1.决定需要绘制的图元是什么

        2.怎样绘制它们

        3.在哪里绘制它们
    
    重要任务:
        把顶点坐标变换到屏幕空间中,再交给光栅器进行处理
        输出屏幕空间的二维顶点坐标、每个顶点对应的深度值、着色等相关信息，并传递给下一个阶段

    可拆分更小流水线阶段
### 2.1.3 光栅化阶段
    负责将 几何阶段 传递的数据 产生屏幕上的像素,并渲染出最终的图像

    主要任务(GPU):
        决定每个渲染图元中的哪些像素应该被绘制在屏幕上,需要对几何阶段得到的逐顶点数据(例如纹理坐标、顶点颜色等)进行插值，然后进行逐像素处理
    
    可拆分更小流水线阶段
## 2.2 CPU和GPU之间的通信
    CPU - 应用阶段
        1 把数据加载到显存中
        2 设置渲染状态
        3 调用 Draw Call
            CPU发起,GPU接收
            GPU会根据渲染状态(例如材质\纹理\着色器等)和所有输入的顶点数据来计算,最终输出成屏幕上显示的那些漂亮的像素
## 2.3 GPU流水线
    图 见Image/GPU流水线图.png

## 2.3.1 顶点着色器
    主要任务:
        坐标变换和逐顶点光照(先坐标变换,再计算顶点颜色)
        见 顶点着色器_坐标变换_计算和输出顶点颜色.jpg

    坐标变换
        o.pos = mul(UNITY_MVP,v.position);
        这句话的意思:把顶点坐标从模型控件转换到齐次裁剪空间
        见 顶点着色器_齐次裁剪坐标空间图.jpg

        扩展
            把数据发送给曲面细分着色器或几何着色器


